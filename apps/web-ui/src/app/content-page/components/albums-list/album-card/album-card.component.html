<div>
  @let imageUrlResult = chosenAlbumImageUrl();
  @if (imageUrlResult | isPending) {
    <div class="skeleton h-full w-full" data-testid="album-image-skeleton">
      <!-- A trick to make the skeleton always be a square, regardless of its width. -->
      <svg viewBox="0 0 1 1"></svg>
    </div>
  } @else if (imageUrlResult | hasFailed) {
    <span data-testid="album-image-error"
      >Error: {{ imageUrlResult.error!.message }}</span
    >
  } @else {
    <img
      class="album-card__image"
      data-testid="album-image"
      [src]="imageUrlResult.data!"
      loading="lazy"
      alt="Album"
    />
  }

  @let albumDetailsResult = albumDetails();
  @if (albumDetailsResult | isPending) {
    <div class="mt-4 mr-0 mb-6" data-testid="album-details-skeleton">
      <div class="skeleton h-2 w-full mb-2"></div>
      <div class="skeleton h-2 w-full"></div>
    </div>
  } @else if (albumDetailsResult | hasFailed) {
    <span>Error: {{ albumDetailsResult.error!.message }}</span>
  } @else {
    @let name = albumDetailsResult.data!.albumName;
    @let mediaItemsCount = albumDetailsResult.data!.mediaItemIds.length;
    @let childAlbumsCount = albumDetailsResult.data!.childAlbumIds.length;

    <div class="album-card__details">
      <div data-testid="album-card-name">
        {{ name }}
      </div>
      <div class="album-card__sub-text">
        @if (mediaItemsCount > 0 && childAlbumsCount > 0) {
          {{ mediaItemsCount }}
          {{ mediaItemsCount === 1 ? 'photo' : 'photos' }} &middot;
          {{ childAlbumsCount }}
          {{ childAlbumsCount === 1 ? 'album' : 'albums' }}
        } @else if (mediaItemsCount > 0) {
          {{ mediaItemsCount }} {{ mediaItemsCount === 1 ? 'photo' : 'photos' }}
        } @else {
          {{ childAlbumsCount }}
          {{ childAlbumsCount === 1 ? 'album' : 'albums' }}
        }
      </div>
    </div>
  }
</div>
