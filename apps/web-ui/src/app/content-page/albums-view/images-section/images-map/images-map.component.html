<div class="h-screen relative">
  <div
    #fullscreenContainer
    [ngClass]="{
      'card bg-base-100 rounded-xl overflow-hidden shadow-xl absolute inset-0 flex flex-col mt-8 mb-8':
        !isFullscreen(),
      'absolute inset-0': !isFullscreen(),
    }"
  >
    @if (heatmapResult() | isPending) {
      <div
        class="absolute top-2 left-2 z-10 flex items-center gap-2 whitespace-nowrap text-s"
      >
        <span class="loading loading-spinner loading-md"></span>
        <div>Loading {{ numTiles() }} tiles</div>
      </div>
    } @else if (heatmapResult() | hasFailed) {
      <div
        class="absolute top-2 left-2 z-10 flex items-center gap-2 whitespace-nowrap text-s"
      >
        <span class="loading loading-spinner loading-md"></span>
        <div>Error: {{ heatmapResult().error }}</div>
      </div>
    }

    <button
      data-testid="fullscreen-button"
      class="btn btn-ghost absolute top-2 right-2 z-10"
      (click)="toggleFullscreen()"
    >
      @if (isFullscreen()) {
        <svg
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          viewBox="0 0 24 24"
          stroke-width="1.5"
          stroke="currentColor"
          class="size-6"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            d="M9 9V4.5M9 9H4.5M9 9 3.75 3.75M9 15v4.5M9 15H4.5M9 15l-5.25 5.25M15 9h4.5M15 9V4.5M15 9l5.25-5.25M15 15h4.5M15 15v4.5m0-4.5 5.25 5.25"
          />
        </svg>
      } @else {
        <svg
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          viewBox="0 0 24 24"
          stroke-width="1.5"
          stroke="currentColor"
          class="size-6"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            d="M3.75 3.75v4.5m0-4.5h4.5m-4.5 0L9 9M3.75 20.25v-4.5m0 4.5h4.5m-4.5 0L9 15M20.25 3.75h-4.5m4.5 0v4.5m0-4.5L15 9m5.25 11.25h-4.5m4.5 0v-4.5m0 4.5L15 15"
          />
        </svg>
      }
    </button>

    <app-images-map-viewer
      class="flex-grow"
      [heatmap]="heatmap()"
      (visibleTilesChanged)="fetchTiles($event, albumId())"
      [isDarkMode]="isDarkMode()"
    />
  </div>
</div>
